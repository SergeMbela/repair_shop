<!DOCTYPE html>
<html lang="fr" class="scroll-smooth scroll-pt-16">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Garage Auto - Accueil</title>
    <!-- Importation de Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Importation de Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <!-- Configuration -->
    <script src="config.js"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
    <style>
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.8s ease-out forwards;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .animate-shake {
            animation: shake 0.3s ease-in-out;
        }
    </style>
</head>
<body class="bg-gray-50 font-sans dark:bg-gray-900 transition-colors duration-300">

    <!-- Barre de Navigation -->
    <nav class="bg-white shadow-lg fixed w-full z-10 top-0 dark:bg-gray-800 transition-colors duration-300">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between h-16">
                
                <!-- Logo / Nom de l'entreprise -->
                <div class="flex items-center">
                    <a href="#" class="flex items-center py-4 px-2">
                        <span class="font-bold text-gray-800 text-2xl dark:text-white">Auto<span class="text-blue-600">Expert</span></span>
                    </a>
                    <div id="shop-status" class="hidden"></div>
                </div>

                <!-- Menu Principal (Desktop) -->
                <div class="hidden md:flex items-center space-x-1">
                    <a href="#entretiens" class="py-4 px-2 text-gray-500 hover:text-blue-600 transition duration-300 font-medium">Entretiens</a>
                    <a href="#prestations" class="py-4 px-2 text-gray-500 hover:text-blue-600 transition duration-300 font-medium">Pneus</a>
                    <a href="#prestations" class="py-4 px-2 text-gray-500 hover:text-blue-600 transition duration-300 font-medium">Nos prestations</a>
                    <!-- Bouton Call-to-Action pour le Rendez-vous -->
                    <a href="#rendez-vous" class="py-2 px-4 bg-blue-600 text-white font-semibold rounded hover:bg-blue-700 transition duration-300 shadow-md ml-4">
                        Rendez-vous
                    </a>
                    <!-- Bouton Dark Mode -->
                    <button id="theme-toggle" type="button" class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 focus:outline-none rounded-lg text-sm p-2.5 ml-4">
                        <svg id="theme-toggle-dark-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"></path></svg>
                        <svg id="theme-toggle-light-icon" class="hidden w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path d="M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 100 2h1z" fill-rule="evenodd" clip-rule="evenodd"></path></svg>
                    </button>
                </div>

                <!-- Bouton Menu Mobile (Hamburger) -->
                <div class="md:hidden flex items-center">
                    <button id="mobile-menu-button" class="outline-none mobile-menu-button">
                        <svg class="w-6 h-6 text-gray-500 hover:text-blue-600"
                            x-show="!showMenu"
                            fill="none"
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            viewBox="0 0 24 24"
                            stroke="currentColor"
                        >
                            <path d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        <!-- Menu Mobile (Cach√© par d√©faut) -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-gray-200 dark:bg-gray-800 dark:border-gray-700">
            <ul class="">
                <li><a href="#entretiens" class="block text-sm px-4 py-4 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition duration-300 dark:text-gray-200 dark:hover:bg-gray-700">Entretiens</a></li>
                <li><a href="#prestations" class="block text-sm px-4 py-4 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition duration-300 dark:text-gray-200 dark:hover:bg-gray-700">Pneus</a></li>
                <li><a href="#prestations" class="block text-sm px-4 py-4 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition duration-300 dark:text-gray-200 dark:hover:bg-gray-700">Nos prestations</a></li>
                <li><a href="#rendez-vous" class="block text-sm px-4 py-4 bg-blue-600 text-white font-semibold hover:bg-blue-700 transition duration-300 text-center">Rendez-vous</a></li>
                <li><button id="mobile-theme-toggle" class="w-full text-left block text-sm px-4 py-4 text-gray-700 hover:bg-blue-50 hover:text-blue-600 transition duration-300 dark:text-gray-200 dark:hover:bg-gray-700">Mode Sombre / Clair</button></li>
            </ul>
        </div>
    </nav>

    <!-- Section H√©ro avec Image de fond et Formulaire -->
    <div id="rendez-vous" class="relative bg-gray-900 mt-16 fade-in">
        <div class="absolute inset-0">
            <img class="w-full h-full object-cover" src="https://images.unsplash.com/photo-1486262715619-67b85e0b08d3?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80" alt="Garage background">
            <div class="absolute inset-0 bg-gray-900 opacity-75"></div>
        </div>
        <div class="relative max-w-7xl mx-auto py-24 px-4 sm:py-32 sm:px-6 lg:px-8 flex flex-col md:flex-row items-center">
            <div class="w-full md:w-1/2 text-center md:text-left mb-10 md:mb-0">
                <h1 class="text-4xl font-extrabold tracking-tight text-white sm:text-5xl lg:text-6xl">
                    Expertise & Confiance
                </h1>
                <p class="mt-6 text-xl text-gray-300 max-w-3xl">
                    Prenez soin de votre v√©hicule avec nos services d'entretien et de r√©paration de haute qualit√©.
                </p>
            </div>
            <div class="w-full md:w-1/2 flex justify-center md:justify-end">
                <div class="bg-white p-8 rounded-lg shadow-2xl w-full max-w-md dark:bg-gray-800">
                    <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center dark:text-white">Rendez-vous Rapide</h2>
                    <form id="appointment-form" action="#" method="POST" class="space-y-4">
                        <div>
                            <label for="name" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Nom complet</label>
                            <input type="text" id="name" name="name" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="Votre nom">
                            <p class="mt-1 text-xs text-red-600 dark:text-red-400 hidden field-error">Ce champ est obligatoire.</p>
                        </div>
                        <div>
                            <label for="phone" class="block text-sm font-medium text-gray-700 dark:text-gray-300">T√©l√©phone</label>
                            <div class="mt-1 flex rounded-md shadow-sm">
                                <select id="phone_prefix" name="phone_prefix" class="rounded-l-md border border-r-0 border-gray-300 bg-gray-50 text-gray-500 text-sm focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white px-3 py-2 w-32">
                                    <option value="+32">üáßüá™ +32</option>
                                    <option value="+33">üá´üá∑ +33</option>
                                    <option value="+352">üá±üá∫ +352</option>
                                    <option value="+31">üá≥üá± +31</option>
                                    <option value="+49">üá©üá™ +49</option>
                                    <option value="+34">üá™üá∏ +34</option>
                                    <option value="+39">üáÆüáπ +39</option>
                                    <option value="+351">üáµüáπ +351</option>
                                    <option value="+44">üá¨üáß +44</option>
                                    <option value="+212">üá≤üá¶ +212</option>
                                    <option value="+213">üá©üáø +213</option>
                                </select>
                                <input type="tel" id="phone" name="phone" required class="flex-1 block w-full px-3 py-2 border border-gray-300 rounded-r-md focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="470 12 34 56">
                            </div>
                            <p class="mt-1 text-xs text-red-600 dark:text-red-400 hidden field-error">Ce champ est obligatoire.</p>
                        </div>
                        <div>
                            <label for="email" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Email</label>
                            <input type="email" id="email" name="email" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="exemple@email.com">
                            <p class="mt-1 text-xs text-red-600 dark:text-red-400 hidden field-error">Veuillez entrer une adresse email valide.</p>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label for="brand" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Marque</label>
                                <select id="brand" name="brand" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                    <option value="">S√©lectionnez une marque</option>
                                </select>
                                <p class="mt-1 text-xs text-red-600 dark:text-red-400 hidden field-error">Veuillez s√©lectionner une marque.</p>
                            </div>
                            <div>
                                <label for="model" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Mod√®le</label>
                                <select id="model" name="model" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white" disabled>
                                    <option value="">S√©lectionnez d'abord une marque</option>
                                </select>
                                <p class="mt-1 text-xs text-red-600 dark:text-red-400 hidden field-error">Veuillez s√©lectionner un mod√®le.</p>
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label for="engine" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Carburant</label>
                                <select id="engine" name="engine" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                    <option value="">S√©lectionnez</option>
                                    <option value="Essence">Essence</option>
                                    <option value="Diesel">Diesel</option>
                                    <option value="Hybride">Hybride</option>
                                    <option value="√âlectrique">√âlectrique</option>
                                    <option value="LPG">LPG</option>
                                    <option value="CNG">CNG</option>
                                </select>
                                <p class="mt-1 text-xs text-red-600 dark:text-red-400 hidden field-error">Veuillez s√©lectionner un carburant.</p>
                            </div>
                            <div>
                                <label for="year" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Ann√©e</label>
                                <input type="number" id="year" name="year" required min="1900" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="2020">
                                <p class="mt-1 text-xs text-red-600 dark:text-red-400 hidden field-error">L'ann√©e est obligatoire.</p>
                            </div>
                        </div>
                        <div>
                            <label for="registration_number" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Immatriculation</label>
                            <input type="text" id="registration_number" name="registration_number" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="Ex: 1-ABC-123">
                            <p class="mt-1 text-xs text-red-600 dark:text-red-400 hidden field-error">L'immatriculation est obligatoire.</p>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300">Date et heure souhait√©es</label>
                            <div class="grid grid-cols-2 gap-4">
                                <div>
                                    <input type="date" id="appointment_date" name="appointment_date" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                </div>
                                <div>
                                    <select id="appointment_time" name="appointment_time" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                        <option value="">Heure</option>
                                    </select>
                                </div>
                            </div>
                            <p class="mt-1 text-xs text-red-600 dark:text-red-400 hidden field-error">Veuillez choisir une date et une heure.</p>
                        </div>
                        <div>
                            <label for="service" class="block text-sm font-medium text-gray-700 dark:text-gray-300">Service</label>
                            <select id="service" name="service" required class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white">
                                <option>Entretien / Vidange</option>
                                <option>Pneus</option>
                                <option>Diagnostic</option>
                                <option>R√©paration m√©canique</option>
                                <option>Freinage</option>
                                <option>Distribution</option>
                                <option>Embrayage</option>
                                <option>Climatisation</option>
                                <option>Carrosserie</option>
                                <option>Pr√©-contr√¥le technique</option>
                                <option>Autre</option>
                            </select>
                            <p class="mt-1 text-xs text-red-600 dark:text-red-400 hidden field-error">Veuillez s√©lectionner un service.</p>
                        </div>
                        <button id="submit-btn" type="submit" class="w-full flex justify-center items-center py-3 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition duration-150 disabled:opacity-50 disabled:cursor-not-allowed">
                            <svg id="btn-spinner" class="animate-spin -ml-1 mr-3 h-5 w-5 text-white hidden" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                            </svg>
                            <span>Demander un RDV</span>
                        </button>
                        <!-- Zone de message (Erreur / Succ√®s) -->
                        <div id="form-message" class="mt-4 text-center text-sm font-medium hidden"></div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Contenu Principal (Exemple) -->
    <div id="prestations" class="py-12 px-4 fade-in">
        <div class="max-w-7xl mx-auto text-center">
            <h1 class="text-4xl font-bold text-gray-800 mb-4 dark:text-white">Bienvenue chez AutoExpert</h1>
            <p class="text-lg text-gray-600 mb-8 dark:text-gray-300">Votre sp√©cialiste pour l'entretien, les pneus et la m√©canique g√©n√©rale.</p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-10">
                <!-- Carte Exemple 1 -->
                <div class="bg-white p-6 rounded-lg shadow-md dark:bg-gray-800">
                    <h3 class="text-xl font-bold mb-2 text-blue-600">Entretiens</h3>
                    <p class="text-gray-600 dark:text-gray-300">Vidange, filtres et r√©vision compl√®te.</p>
                </div>
                <!-- Carte Exemple 2 -->
                <div class="bg-white p-6 rounded-lg shadow-md dark:bg-gray-800">
                    <h3 class="text-xl font-bold mb-2 text-blue-600">Pneus</h3>
                    <p class="text-gray-600 dark:text-gray-300">Montage, √©quilibrage et g√©om√©trie.</p>
                </div>
                <!-- Carte Exemple 3 -->
                <div class="bg-white p-6 rounded-lg shadow-md dark:bg-gray-800">
                    <h3 class="text-xl font-bold mb-2 text-blue-600">M√©canique</h3>
                    <p class="text-gray-600 dark:text-gray-300">R√©parations complexes et diagnostics.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Section Tarifs / Forfaits -->
    <div id="entretiens" class="bg-white py-16 px-4 fade-in">
        <div class="max-w-7xl mx-auto">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-800">Nos Forfaits Entretien</h2>
                <p class="mt-4 text-gray-600">Des solutions adapt√©es √† vos besoins et √† votre budget.</p>
            </div>
            
            <div id="packages-grid" class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- Loader pendant le chargement -->
                <div class="col-span-1 md:col-span-3 text-center py-10">
                    <svg class="animate-spin h-8 w-8 text-blue-600 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <p class="mt-2 text-gray-500 dark:text-gray-400">Chargement des offres...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Section T√©moignages Clients -->
    <div class="bg-gray-100 py-16 px-4 fade-in">
        <div class="max-w-7xl mx-auto">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-12">Ce que disent nos clients</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                
                <!-- T√©moignage 1 -->
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <div class="flex items-center mb-4">
                        <img class="w-12 h-12 rounded-full object-cover mr-4" src="https://randomuser.me/api/portraits/men/32.jpg" alt="Jean Dupont">
                        <div>
                            <h4 class="font-bold text-gray-800">Jean Dupont</h4>
                            <div class="flex text-yellow-400">
                                <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                            </div>
                        </div>
                    </div>
                    <p class="text-gray-600 italic dark:text-gray-300">"Service impeccable ! Ma voiture a √©t√© r√©par√©e en un temps record. Je recommande vivement ce garage pour leur professionnalisme."</p>
                </div>

                <!-- T√©moignage 2 -->
                <div class="bg-white p-6 rounded-lg shadow-lg dark:bg-gray-800">
                    <div class="flex items-center mb-4">
                        <img class="w-12 h-12 rounded-full object-cover mr-4" src="https://randomuser.me/api/portraits/women/44.jpg" alt="Sophie Martin">
                        <div>
                            <h4 class="font-bold text-gray-800 dark:text-white">Sophie Martin</h4>
                            <div class="flex text-yellow-400">
                                <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                            </div>
                        </div>
                    </div>
                    <p class="text-gray-600 italic dark:text-gray-300">"Tr√®s bon accueil et tarifs transparents. J'ai fait changer mes pneus ici et tout s'est tr√®s bien pass√©."</p>
                </div>

                <!-- T√©moignage 3 -->
                <div class="bg-white p-6 rounded-lg shadow-lg dark:bg-gray-800">
                    <div class="flex items-center mb-4">
                        <img class="w-12 h-12 rounded-full object-cover mr-4" src="https://randomuser.me/api/portraits/men/85.jpg" alt="Marc Dubois">
                        <div>
                            <h4 class="font-bold text-gray-800 dark:text-white">Marc Dubois</h4>
                            <div class="flex text-yellow-400">
                                <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                <svg class="w-4 h-4 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                                <svg class="w-4 h-4 text-gray-300 fill-current" viewBox="0 0 20 20"><path d="M10 15l-5.878 3.09 1.123-6.545L.489 6.91l6.572-.955L10 0l2.939 5.955 6.572.955-4.756 4.635 1.123 6.545z"/></svg>
                            </div>
                        </div>
                    </div>
                    <p class="text-gray-600 italic dark:text-gray-300">"Un garage honn√™te, ce qui est rare de nos jours. Le diagnostic √©tait pr√©cis et la facture conforme au devis."</p>
                </div>

            </div>
        </div>
    </div>

    <!-- Section FAQ (Foire Aux Questions) -->
    <div class="bg-white py-16 px-4 fade-in dark:bg-gray-900">
        <div class="max-w-3xl mx-auto">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-12 dark:text-white">Questions Fr√©quentes</h2>
            <div class="space-y-4">
                <!-- Question 1 -->
                <div class="border border-gray-200 rounded-lg dark:border-gray-700">
                    <button class="flex items-center justify-between w-full p-4 text-left focus:outline-none faq-btn">
                        <span class="text-lg font-medium text-gray-800 dark:text-white">Faut-il prendre rendez-vous pour une vidange ?</span>
                        <svg class="w-5 h-5 text-gray-500 transform transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="hidden px-4 pb-4 text-gray-600 faq-content dark:text-gray-300">
                        Bien que nous acceptions les visites sans rendez-vous selon disponibilit√©s, il est fortement recommand√© de r√©server pour garantir une prise en charge imm√©diate.
                    </div>
                </div>
                <!-- Question 2 -->
                <div class="border border-gray-200 rounded-lg dark:border-gray-700">
                    <button class="flex items-center justify-between w-full p-4 text-left focus:outline-none faq-btn">
                        <span class="text-lg font-medium text-gray-800 dark:text-white">Proposez-vous un v√©hicule de courtoisie ?</span>
                        <svg class="w-5 h-5 text-gray-500 transform transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="hidden px-4 pb-4 text-gray-600 faq-content dark:text-gray-300">
                        Oui, nous disposons de v√©hicules de pr√™t pour les interventions durant plus de 4 heures. Pensez √† le demander lors de la prise de rendez-vous.
                    </div>
                </div>
                <!-- Question 3 -->
                <div class="border border-gray-200 rounded-lg dark:border-gray-700">
                    <button class="flex items-center justify-between w-full p-4 text-left focus:outline-none faq-btn">
                        <span class="text-lg font-medium text-gray-800 dark:text-white">Les devis sont-ils gratuits ?</span>
                        <svg class="w-5 h-5 text-gray-500 transform transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="hidden px-4 pb-4 text-gray-600 faq-content dark:text-gray-300">
                        Absolument. Nous r√©alisons un devis gratuit et d√©taill√© avant toute intervention. Aucune r√©paration n'est effectu√©e sans votre accord.
                    </div>
                </div>
                <!-- Question 4 -->
                <div class="border border-gray-200 rounded-lg dark:border-gray-700">
                    <button class="flex items-center justify-between w-full p-4 text-left focus:outline-none faq-btn">
                        <span class="text-lg font-medium text-gray-800 dark:text-white">Quelle est la dur√©e de garantie des r√©parations ?</span>
                        <svg class="w-5 h-5 text-gray-500 transform transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div class="hidden px-4 pb-4 text-gray-600 faq-content dark:text-gray-300">
                        Toutes nos interventions pi√®ces et main d'≈ìuvre sont garanties 1 an. Certaines pi√®ces sp√©cifiques peuvent b√©n√©ficier d'une garantie constructeur plus longue.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Pied de page (Footer) -->
    <footer class="bg-gray-800 text-white pt-12 pb-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                
                <!-- Colonne 1 : √Ä propos -->
                <div>
                    <h3 class="text-xl font-bold mb-4">Auto<span class="text-blue-500">Expert</span></h3>
                    <p class="text-gray-400 text-sm">
                        Votre partenaire de confiance pour l'entretien automobile. Qualit√©, rapidit√© et transparence sont nos ma√Ætres-mots.
                    </p>
                </div>

                <!-- Colonne 2 : Coordonn√©es -->
                <div>
                    <h3 class="text-lg font-semibold mb-4">Nous contacter</h3>
                    <ul class="space-y-2 text-gray-400 text-sm">
                        <li class="flex items-start">
                            <svg class="w-5 h-5 mr-2 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                            <span>123 Avenue de la M√©canique<br>1000 Bruxelles</span>
                        </li>
                        <li class="flex items-center">
                            <svg class="w-5 h-5 mr-2 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path></svg>
                            <span>02 123 45 67</span>
                        </li>
                        <li class="flex items-center">
                            <svg class="w-5 h-5 mr-2 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                            <span>contact@autoexpert.be</span>
                        </li>
                    </ul>
                </div>

                <!-- Colonne 3 : Horaires -->
                <div>
                    <h3 class="text-lg font-semibold mb-4">Horaires d'ouverture</h3>
                    <ul class="space-y-2 text-gray-400 text-sm">
                        <li class="flex justify-between"><span>Lundi - Vendredi :</span> <span>07h00 - 20h00</span></li>
                        <li class="flex justify-between"><span>Samedi :</span> <span>09h00 - 12h30</span></li>
                        <li class="flex justify-between"><span>Dimanche :</span> <span class="text-red-400">Ferm√©</span></li>
                    </ul>
                </div>
            </div>

            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-500 text-sm">
                &copy; 2023 AutoExpert. Tous droits r√©serv√©s. | <a href="mentions-legales.html" class="hover:text-white transition duration-300">Mentions L√©gales</a> | <a href="#" class="hover:text-white transition duration-300 privacy-policy-link">Politique de confidentialit√©</a>
            </div>
        </div>
    </footer>

    <!-- Bouton Retour en haut -->
    <button id="back-to-top" class="fixed bottom-8 right-8 bg-blue-600 text-white p-3 rounded-full shadow-lg hover:bg-blue-700 transition duration-300 hidden z-50 focus:outline-none" aria-label="Retour en haut">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
        </svg>
    </button>

    <!-- Banni√®re Cookies -->
    <div id="cookie-banner" class="fixed bottom-0 left-0 right-0 bg-gray-900 text-white p-4 shadow-lg z-50 hidden">
        <div class="max-w-7xl mx-auto flex flex-col md:flex-row items-center justify-between">
            <p class="mb-4 md:mb-0 text-sm text-gray-300">
                Nous utilisons des cookies pour am√©liorer votre exp√©rience. En continuant √† naviguer sur ce site, vous acceptez notre utilisation des cookies. <a href="#" class="underline hover:text-blue-400 transition duration-300 privacy-policy-link">Politique de confidentialit√©</a>.
            </p>
            <button id="accept-cookies-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-6 rounded transition duration-300">
                Accepter
            </button>
        </div>
    </div>

    <!-- Modale Politique de Confidentialit√© -->
    <div id="privacy-modal" class="fixed inset-0 z-[60] hidden overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <!-- Background overlay -->
            <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true" id="privacy-modal-overlay"></div>

            <!-- Center modal -->
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>

            <div class="inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full">
                <div class="bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="sm:flex sm:items-start">
                        <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
                            <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-white" id="modal-title">
                                Politique de Confidentialit√©
                            </h3>
                            <div class="mt-4 text-sm text-gray-500 dark:text-gray-300 max-h-96 overflow-y-auto pr-2">
                                <p class="mb-4"><strong>1. Collecte de l'information</strong><br>
                                Nous recueillons des informations lorsque vous prenez rendez-vous sur notre site. Les informations recueillies incluent votre nom, votre num√©ro de t√©l√©phone et les d√©tails de votre v√©hicule.</p>
                                
                                <p class="mb-4"><strong>2. Utilisation des informations</strong><br>
                                Toute les informations que nous recueillons aupr√®s de vous peuvent √™tre utilis√©es pour :
                                <ul class="list-disc pl-5 mb-2">
                                    <li>Traiter votre demande de rendez-vous</li>
                                    <li>Vous contacter par t√©l√©phone ou email concernant votre v√©hicule</li>
                                    <li>Am√©liorer notre service client</li>
                                </ul>
                                </p>

                                <p class="mb-4"><strong>3. Confidentialit√© des donn√©es</strong><br>
                                Nous sommes les seuls propri√©taires des informations recueillies sur ce site. Vos informations personnelles ne seront pas vendues, √©chang√©es, transf√©r√©es, ou donn√©es √† une autre soci√©t√© pour n'importe quelle raison, sans votre consentement.</p>

                                <p class="mb-4"><strong>4. Divulgation √† des tiers</strong><br>
                                Nous ne vendons, n'√©changeons et ne transf√©rons pas vos informations personnelles identifiables √† des tiers.</p>

                                <p class="mb-4"><strong>5. Protection des informations</strong><br>
                                Nous mettons en ≈ìuvre une vari√©t√© de mesures de s√©curit√© pour pr√©server la s√©curit√© de vos informations personnelles.</p>

                                <p class="mb-4"><strong>6. Consentement</strong><br>
                                En utilisant notre site, vous consentez √† notre politique de confidentialit√©.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-50 dark:bg-gray-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button type="button" id="close-privacy-modal" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm">
                        Fermer
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modale Confirmation Rendez-vous -->
    <div id="confirmation-modal" class="fixed inset-0 z-[70] hidden overflow-y-auto" aria-labelledby="modal-title" role="dialog" aria-modal="true">
        <div class="flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity" aria-hidden="true" id="confirmation-modal-overlay"></div>
            <span class="hidden sm:inline-block sm:align-middle sm:h-screen" aria-hidden="true">&#8203;</span>
            <div class="inline-block align-bottom bg-white dark:bg-gray-800 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
                <div class="bg-white dark:bg-gray-800 px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                    <div class="sm:flex sm:items-start">
                        <div class="mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-green-100 sm:mx-0 sm:h-10 sm:w-10">
                            <svg class="h-6 w-6 text-green-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                        </div>
                        <div class="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full">
                            <h3 class="text-lg leading-6 font-medium text-gray-900 dark:text-white" id="modal-title">
                                Demande envoy√©e avec succ√®s !
                            </h3>
                            <div class="mt-2">
                                <p class="text-sm text-gray-500 dark:text-gray-400">
                                    Nous avons bien re√ßu votre demande. Un email de confirmation vous a √©t√© envoy√©.
                                </p>
                                <div class="mt-4 bg-gray-50 dark:bg-gray-700 rounded-md p-4 text-left border border-gray-200 dark:border-gray-600">
                                    <h4 class="text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2">R√©capitulatif :</h4>
                                    <ul class="text-sm text-gray-600 dark:text-gray-400 space-y-1">
                                        <li><span class="font-medium">Nom :</span> <span id="conf-name"></span></li>
                                        <li><span class="font-medium">Date :</span> <span id="conf-date"></span></li>
                                        <li><span class="font-medium">V√©hicule :</span> <span id="conf-vehicle"></span></li>
                                        <li><span class="font-medium">Service :</span> <span id="conf-service"></span></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="bg-gray-50 dark:bg-gray-700 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                    <button type="button" id="close-confirmation-modal" class="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm">
                        Fermer
                    </button>
                    <a id="btn-google-calendar" target="_blank" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm dark:bg-gray-600 dark:text-white dark:border-gray-500 dark:hover:bg-gray-500 cursor-pointer">
                        Google Agenda
                    </a>
                    <a id="btn-outlook-calendar" class="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm dark:bg-gray-600 dark:text-white dark:border-gray-500 dark:hover:bg-gray-500 cursor-pointer">
                        Outlook / iCal
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Script simple pour le menu mobile -->
    <script>
        // Menu Mobile
        const btn = document.getElementById('mobile-menu-button');
        const menu = document.getElementById('mobile-menu');

        btn.addEventListener('click', () => {
            menu.classList.toggle('hidden');
        });

        // Fermer le menu mobile lors du clic sur un lien
        menu.querySelectorAll('a').forEach(link => {
            link.addEventListener('click', () => {
                menu.classList.add('hidden');
            });
        });

        // FAQ Accord√©on
        const faqBtns = document.querySelectorAll('.faq-btn');

        faqBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const content = btn.nextElementSibling;
                const icon = btn.querySelector('svg');
                
                content.classList.toggle('hidden');
                icon.classList.toggle('rotate-180');
            });
        });

        // Bouton Retour en haut
        const backToTopBtn = document.getElementById('back-to-top');

        window.addEventListener('scroll', () => {
            if (window.scrollY > 300) {
                backToTopBtn.classList.remove('hidden');
            } else {
                backToTopBtn.classList.add('hidden');
            }
        });

        backToTopBtn.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        // Gestion du formulaire de rendez-vous (Validation + Envoi Supabase)
        const form = document.getElementById('appointment-form');
        const yearInput = document.getElementById('year');
        const phoneInput = document.getElementById('phone');
        const messageDiv = document.getElementById('form-message');
        const submitBtn = document.getElementById('submit-btn');
        const btnSpinner = document.getElementById('btn-spinner');

        if (form) {
            const dateInputEl = document.getElementById('appointment_date');
            const timeInputEl = document.getElementById('appointment_time');

            // G√©n√©rer les cr√©neaux horaires (07:00 - 20:00, pas de 15 min)
            if (timeInputEl) {
                const startHour = 7;
                const endHour = 20;
                for (let h = startHour; h <= endHour; h++) {
                    for (let m = 0; m < 60; m += 15) {
                        if (h === endHour && m > 0) break; // Arr√™ter √† 20:00 pile
                        const time = `${h.toString().padStart(2, '0')}:${m.toString().padStart(2, '0')}`;
                        const option = document.createElement('option');
                        option.value = time;
                        option.textContent = time;
                        timeInputEl.appendChild(option);
                    }
                }
            }

            // Validation personnalis√©e pour la date et l'heure
            function validateDateTime() {
                if (!dateInputEl || !timeInputEl) return;
                dateInputEl.setCustomValidity(""); // R√©initialiser
                timeInputEl.setCustomValidity("");

                if (!dateInputEl.value || !timeInputEl.value) return;

                const selectedDate = new Date(dateInputEl.value + 'T' + timeInputEl.value);
                const now = new Date();

                if (selectedDate < now) {
                    dateInputEl.setCustomValidity("La date ne peut pas √™tre dans le pass√©.");
                    return;
                }
            }

            // Gestion des erreurs visuelles
            const inputs = form.querySelectorAll('input, select');
            
            function validateField(input) {
                let errorMsg = input.parentElement.querySelector('.field-error');
                if (!errorMsg && input.id === 'phone') {
                    errorMsg = input.parentElement.parentElement.querySelector('.field-error');
                }
                if (!errorMsg && (input.id === 'appointment_date' || input.id === 'appointment_time')) {
                    errorMsg = input.parentElement.parentElement.parentElement.querySelector('.field-error');
                }

                if (errorMsg) {
                    // Appliquer la validation date si n√©cessaire
                    if (input.id === 'appointment_date' || input.id === 'appointment_time') validateDateTime();

                    if (!input.checkValidity()) {
                        errorMsg.classList.remove('hidden');
                        if (input.validationMessage) {
                            errorMsg.textContent = input.validationMessage;
                        }
                        input.classList.add('border-red-500', 'focus:border-red-500', 'focus:ring-red-500');
                        input.classList.remove('border-gray-300', 'focus:border-blue-500', 'focus:ring-blue-500');
                    } else {
                        errorMsg.classList.add('hidden');
                        input.classList.remove('border-red-500', 'focus:border-red-500', 'focus:ring-red-500');
                        input.classList.add('border-gray-300', 'focus:border-blue-500', 'focus:ring-blue-500');
                    }
                }
            }

            inputs.forEach(input => {
                input.addEventListener('blur', () => validateField(input));
                input.addEventListener('input', () => {
                    if (input.classList.contains('border-red-500')) validateField(input);
                });
                input.addEventListener('change', () => validateField(input));
            });

            // Gestion visuelle du bouton (au lieu de disabled) pour permettre le clic et l'animation
            const updateButtonState = () => {
                if (dateInputEl) validateDateTime();
                const isValid = form.checkValidity();
                if (isValid) {
                    submitBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                } else {
                    submitBtn.classList.add('opacity-50', 'cursor-not-allowed');
                }
            };
            form.addEventListener('input', updateButtonState);
            form.addEventListener('change', updateButtonState);
            updateButtonState(); // V√©rification initiale

            submitBtn.addEventListener('click', (e) => {
                if (!form.checkValidity()) {
                    e.preventDefault();
                    submitBtn.classList.add('animate-shake');
                    setTimeout(() => submitBtn.classList.remove('animate-shake'), 500);
                    // Afficher les erreurs sur tous les champs
                    inputs.forEach(input => validateField(input));
                }
            });

            // D√©finir la date minimale √† aujourd'hui pour l'UX
            if (dateInputEl) {
                const now = new Date();
                // Format YYYY-MM-DD
                dateInputEl.min = now.toISOString().slice(0, 10);
            }
            // D√©finir l'ann√©e max √† l'ann√©e courante
            const yearInputEl = document.getElementById('year');
            if (yearInputEl) {
                const currentYear = new Date().getFullYear();
                yearInputEl.max = currentYear;
            }

            form.addEventListener('submit', async (e) => {
                e.preventDefault(); // Emp√™che le rechargement de la page

                // R√©initialisation du message
                messageDiv.classList.add('hidden');
                messageDiv.classList.remove('text-red-600', 'text-green-600', 'dark:text-red-400', 'dark:text-green-400');
                messageDiv.textContent = '';

                // 2. Validation du t√©l√©phone (Belge)
                if (phoneInput && phoneInput.value) {
                    // Nettoyage : on ne garde que les chiffres
                    const phoneClean = phoneInput.value.replace(/\D/g, '');

                    // Validation simplifi√©e pour l'international (au moins 8 chiffres)
                    if (phoneClean.length < 8) {
                        messageDiv.textContent = "Veuillez saisir un num√©ro de t√©l√©phone valide.";
                        messageDiv.classList.add('text-red-600', 'dark:text-red-400');
                        messageDiv.classList.remove('hidden');
                        return;
                    }
                }

                // 3. Validation de la date (Pas dans le pass√©)
                if (dateInputEl && dateInputEl.value && timeInputEl && timeInputEl.value) {
                    const selectedDate = new Date(dateInputEl.value + 'T' + timeInputEl.value);
                    const now = new Date();
                    if (selectedDate < now) {
                        messageDiv.textContent = "La date souhait√©e ne peut pas √™tre dans le pass√©.";
                        messageDiv.classList.add('text-red-600', 'dark:text-red-400');
                        messageDiv.classList.remove('hidden');
                        return;
                    }
                }

                // D√©sactiver le bouton et afficher le spinner
                submitBtn.disabled = true;
                btnSpinner.classList.remove('hidden');

                // 2. R√©cup√©ration des donn√©es
                const formData = new FormData(form);
                const brandSelectEl = document.getElementById('brand');
                // On r√©cup√®re le texte de la marque (ex: "Renault") car la value est l'ID
                const brandText = brandSelectEl.options[brandSelectEl.selectedIndex].text;
                
                // Nettoyage du num√©ro de t√©l√©phone (suppression du 0 initial et des caract√®res non num√©riques)
                let cleanPhone = formData.get('phone').replace(/\D/g, '');
                if (cleanPhone.startsWith('0')) {
                    cleanPhone = cleanPhone.substring(1);
                }

                const appointmentData = {
                    full_name: formData.get('name'),
                    email: formData.get('email'),
                    phone: document.getElementById('phone_prefix').value + cleanPhone,
                    vehicle_brand: brandText === "S√©lectionnez une marque" ? null : brandText,
                    vehicle_model: formData.get('model'),
                    vehicle_engine: formData.get('engine'),
                    vehicle_year: formData.get('year') ? parseInt(formData.get('year')) : null,
                    registration_number: formData.get('registration_number') || null,
                    requested_date: (formData.get('appointment_date') && formData.get('appointment_time')) ? (formData.get('appointment_date') + 'T' + formData.get('appointment_time') + ':00') : null,
                    service_requested: formData.get('service'),
                    status: 'pending'
                };

                // 3. Envoi vers Supabase
                const { error } = await supabaseClient
                    .from('appointments')
                    .insert([appointmentData]);

                // R√©activer le bouton et cacher le spinner
                submitBtn.disabled = false;
                btnSpinner.classList.add('hidden');

                if (error) {
                    console.error('Erreur Supabase:', error);
                    messageDiv.textContent = "Une erreur est survenue lors de l'envoi. Veuillez r√©essayer.";
                    messageDiv.classList.add('text-red-600', 'dark:text-red-400');
                    messageDiv.classList.remove('hidden');
                } else {
                    // Envoi de l'email de confirmation via Edge Function
                    const dateObj = new Date(appointmentData.requested_date);
                    const dateStr = dateObj.toLocaleDateString('fr-BE', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });
                    const timeStr = dateObj.toLocaleTimeString('fr-BE', { hour: '2-digit', minute: '2-digit' });
                    const messageBody = `Bonjour ${appointmentData.full_name},\n\nNous avons bien re√ßu votre demande de rendez-vous pour le ${dateStr} √† ${timeStr}.\n\nNous traiterons votre demande dans les plus brefs d√©lais.\n\nCordialement,\nL'√©quipe AutoExpert`;

                    supabaseClient.functions.invoke('SendSms', {
                        body: {
                            email: appointmentData.email,
                            name: appointmentData.full_name,
                            message: messageBody,
                            channels: ['email'],
                            phoneNumber: appointmentData.phone,
                            phone: appointmentData.phone
                        },
                        headers: {
                            Authorization: `Bearer ${supabaseKey}`
                        }
                    }).then(({ error }) => {
                        if (error) console.error('Erreur envoi email confirmation:', error);
                    });

                    // Afficher la modale de confirmation
                    document.getElementById('conf-name').textContent = appointmentData.full_name;
                    document.getElementById('conf-date').textContent = `${dateStr} √† ${timeStr}`;
                    document.getElementById('conf-vehicle').textContent = `${appointmentData.vehicle_brand} ${appointmentData.vehicle_model}`;
                    document.getElementById('conf-service').textContent = appointmentData.service_requested;
                    document.getElementById('confirmation-modal').classList.remove('hidden');

                    // G√©n√©ration des liens calendrier
                    const startDate = new Date(appointmentData.requested_date);
                    const endDate = new Date(startDate.getTime() + 60 * 60 * 1000); // Dur√©e estim√©e 1h
                    const title = `Rendez-vous AutoExpert - ${appointmentData.service_requested}`;
                    const details = `V√©hicule: ${appointmentData.vehicle_brand} ${appointmentData.vehicle_model}\nImmatriculation: ${appointmentData.registration_number || 'N/A'}\nClient: ${appointmentData.full_name}`;
                    const location = "123 Avenue de la M√©canique, 1000 Bruxelles";

                    // Google Calendar
                    const googleUrl = new URL('https://calendar.google.com/calendar/render');
                    googleUrl.searchParams.append('action', 'TEMPLATE');
                    googleUrl.searchParams.append('text', title);
                    googleUrl.searchParams.append('dates', startDate.toISOString().replace(/-|:|\.\d\d\d/g, '') + '/' + endDate.toISOString().replace(/-|:|\.\d\d\d/g, ''));
                    googleUrl.searchParams.append('details', details);
                    googleUrl.searchParams.append('location', location);
                    document.getElementById('btn-google-calendar').href = googleUrl.toString();

                    // Outlook / iCal (ICS)
                    const icsContent = `BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//AutoExpert//Rendez-vous//FR\nBEGIN:VEVENT\nUID:${Date.now()}@autoexpert.be\nDTSTAMP:${new Date().toISOString().replace(/-|:|\.\d\d\d/g, '')}\nDTSTART:${startDate.toISOString().replace(/-|:|\.\d\d\d/g, '')}\nDTEND:${endDate.toISOString().replace(/-|:|\.\d\d\d/g, '')}\nSUMMARY:${title}\nDESCRIPTION:${details.replace(/\n/g, '\\n')}\nLOCATION:${location}\nEND:VEVENT\nEND:VCALENDAR`;
                    
                    const blob = new Blob([icsContent], { type: 'text/calendar;charset=utf-8' });
                    const icsUrl = URL.createObjectURL(blob);
                    const outlookBtn = document.getElementById('btn-outlook-calendar');
                    outlookBtn.href = icsUrl;
                    outlookBtn.download = 'rendez-vous-autoexpert.ics';

                    form.reset();
                    // R√©initialiser le select mod√®le
                    const modelSelectEl = document.getElementById('model');
                    if (modelSelectEl) {
                        modelSelectEl.innerHTML = '<option value="">S√©lectionnez d\'abord une marque</option>';
                        modelSelectEl.disabled = true;
                    }
                }
            });
        }

        // Gestion du Mode Sombre
        const themeToggleBtn = document.getElementById('theme-toggle');
        const mobileThemeToggleBtn = document.getElementById('mobile-theme-toggle');
        const themeToggleDarkIcon = document.getElementById('theme-toggle-dark-icon');
        const themeToggleLightIcon = document.getElementById('theme-toggle-light-icon');

        // V√©rification de la pr√©f√©rence initiale
        if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            themeToggleLightIcon.classList.remove('hidden');
            document.documentElement.classList.add('dark');
        } else {
            themeToggleDarkIcon.classList.remove('hidden');
            document.documentElement.classList.remove('dark');
        }

        // Fonction de bascule
        function toggleTheme() {
            // Bascule des ic√¥nes
            themeToggleDarkIcon.classList.toggle('hidden');
            themeToggleLightIcon.classList.toggle('hidden');

            // Si le mode sombre √©tait activ√© via localStorage
            if (localStorage.getItem('color-theme')) {
                if (localStorage.getItem('color-theme') === 'light') {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('color-theme', 'dark');
                } else {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('color-theme', 'light');
                }
            } else {
                if (document.documentElement.classList.contains('dark')) {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('color-theme', 'light');
                } else {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('color-theme', 'dark');
                }
            }
        }

        themeToggleBtn.addEventListener('click', toggleTheme);
        if(mobileThemeToggleBtn) mobileThemeToggleBtn.addEventListener('click', toggleTheme);

        // --- Int√©gration Supabase pour les listes d√©roulantes ---
        
        if (!window.CONFIG) {
            console.error("Erreur critique : window.CONFIG n'est pas d√©fini. Le fichier config.js est probablement vide ou manquant.");
            throw new Error("Configuration Supabase manquante. V√©rifiez que config.js est bien charg√©.");
        }

        const supabaseUrl = window.CONFIG.SUPABASE_URL;
        const supabaseKey = window.CONFIG.SUPABASE_KEY;
        const supabaseClient = supabase.createClient(supabaseUrl, supabaseKey);

        // V√©rification de la connexion
        supabaseClient.from('vehicle_brands').select('count', { count: 'exact', head: true }).then(({ error }) => {
            if (error) console.error('Erreur connexion Supabase:', error);
            else console.log('Connexion Supabase OK');
        });

        const brandSelect = document.getElementById('brand');
        const modelSelect = document.getElementById('model');

        // 1. Charger les marques au d√©marrage
        async function loadBrands() {
            const { data: brands, error } = await supabaseClient
                .from('vehicle_brands')
                .select('*')
                .order('name');

            if (error) {
                console.error('Erreur lors du chargement des marques:', error);
                return;
            }

            brands.forEach(brand => {
                const option = document.createElement('option');
                option.value = brand.id; // On utilise l'ID pour filtrer les mod√®les
                option.textContent = brand.name;
                brandSelect.appendChild(option);
            });
        }

        // 2. Charger les mod√®les quand une marque est s√©lectionn√©e
        brandSelect.addEventListener('change', async (e) => {
            const brandId = e.target.value;
            
            // R√©initialiser le select des mod√®les
            modelSelect.innerHTML = '<option value="">S√©lectionnez un mod√®le</option>';
            modelSelect.disabled = true;

            if (brandId) {
                const { data: models, error } = await supabaseClient
                    .from('vehicle_models')
                    .select('*')
                    .eq('brand_id', brandId)
                    .order('name');
                
                if (!error && models.length > 0) {
                    models.forEach(model => {
                        const option = document.createElement('option');
                        option.value = model.name; // Ici on peut garder le nom pour l'envoi du formulaire
                        option.textContent = model.name;
                        modelSelect.appendChild(option);
                    });
                    modelSelect.disabled = false;
                    // D√©clencher une v√©rification du formulaire pour mettre √† jour l'√©tat du bouton
                    if (form) form.dispatchEvent(new Event('change'));
                }
            }
        });

        // Lancer le chargement
        loadBrands();

        // 3. Charger les forfaits d'entretien
        async function loadServicePackages() {
            const grid = document.getElementById('packages-grid');
            
            // R√©cup√©ration des donn√©es depuis Supabase
            const { data: packages, error } = await supabaseClient
                .from('service_packages')
                .select('*')
                .order('display_order', { ascending: true });

            if (error) {
                console.error('Erreur chargement forfaits:', error);
                grid.innerHTML = '<div class="col-span-1 md:col-span-3 text-center text-red-500">Impossible de charger les tarifs pour le moment.</div>';
                return;
            }

            if (packages && packages.length > 0) {
                grid.innerHTML = ''; // On vide le loader

                packages.forEach(pkg => {
                    // D√©finition des styles selon si c'est "Populaire" ou non
                    const isPopular = pkg.is_popular;
                    
                    // Classes du conteneur
                    let containerClass = isPopular 
                        ? "border-2 border-blue-500 rounded-lg shadow-lg p-8 relative transform md:-translate-y-2 bg-white dark:bg-gray-800"
                        : "border border-gray-200 rounded-lg shadow-sm p-8 hover:shadow-lg transition duration-300 dark:border-gray-700 dark:bg-gray-800";
                    
                    // Badge Populaire
                    const badge = isPopular 
                        ? '<div class="absolute top-0 right-0 -mt-4 mr-4 bg-blue-500 text-white text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wide">Populaire</div>' 
                        : '';

                    // Bouton
                    const btnClass = isPopular
                        ? "bg-blue-600 text-white hover:bg-blue-700"
                        : "bg-gray-100 text-gray-800 hover:bg-gray-200 dark:bg-gray-700 dark:text-white dark:hover:bg-gray-600";

                    // Liste des fonctionnalit√©s (features est un tableau JSONB)
                    let featuresList = '<ul class="mt-6 space-y-4">';
                    if (Array.isArray(pkg.features)) {
                        pkg.features.forEach(feat => {
                            featuresList += `
                                <li class="flex items-center">
                                    <svg class="h-5 w-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>
                                    <span class="ml-3 text-gray-600 dark:text-gray-300">${feat}</span>
                                </li>`;
                        });
                    }
                    featuresList += '</ul>';

                    // Construction du HTML
                    const html = `
                        <div class="${containerClass}">
                            ${badge}
                            <h3 class="text-xl font-semibold text-gray-800 dark:text-white">${pkg.title}</h3>
                            <p class="mt-4 text-gray-500 dark:text-gray-400">${pkg.description}</p>
                            <div class="mt-6">
                                <span class="text-4xl font-bold text-gray-800 dark:text-white">${pkg.price}‚Ç¨</span>
                                <span class="text-base font-medium text-gray-500 dark:text-gray-400">/ intervention</span>
                            </div>
                            ${featuresList}
                            <a href="#rendez-vous" onclick="selectService('${pkg.title}')" class="mt-8 block w-full border border-transparent rounded-md py-3 px-6 text-center font-medium transition duration-300 ${btnClass}">Choisir</a>
                        </div>
                    `;

                    grid.insertAdjacentHTML('beforeend', html);
                });
            }
        }

        // Fonction pour pr√©-s√©lectionner le service dans le formulaire
        window.selectService = (serviceName) => {
            const select = document.getElementById('service');
            // On cherche une option qui contient le nom du service
            for (let i = 0; i < select.options.length; i++) {
                if (select.options[i].text.includes(serviceName) || serviceName.includes(select.options[i].text)) {
                    select.selectedIndex = i;
                    break;
                }
            }
        };

        loadServicePackages();

        // Gestion des Cookies
        const cookieBanner = document.getElementById('cookie-banner');
        const acceptCookiesBtn = document.getElementById('accept-cookies-btn');

        if (!localStorage.getItem('cookiesAccepted')) {
            setTimeout(() => {
                cookieBanner.classList.remove('hidden');
            }, 1000);
        }

        acceptCookiesBtn.addEventListener('click', () => {
            localStorage.setItem('cookiesAccepted', 'true');
            cookieBanner.classList.add('hidden');
        });

        // Gestion de la Modale Politique de Confidentialit√©
        const privacyModal = document.getElementById('privacy-modal');
        const privacyLinks = document.querySelectorAll('.privacy-policy-link');
        const closePrivacyModalBtn = document.getElementById('close-privacy-modal');
        const privacyModalOverlay = document.getElementById('privacy-modal-overlay');

        function openPrivacyModal(e) {
            e.preventDefault();
            privacyModal.classList.remove('hidden');
        }

        function closePrivacyModal() {
            privacyModal.classList.add('hidden');
        }

        privacyLinks.forEach(link => {
            link.addEventListener('click', openPrivacyModal);
        });

        if(closePrivacyModalBtn) closePrivacyModalBtn.addEventListener('click', closePrivacyModal);
        if(privacyModalOverlay) privacyModalOverlay.addEventListener('click', closePrivacyModal);

        // Gestion du statut Ouvert/Ferm√© en temps r√©el
        function updateShopStatus() {
            const statusEl = document.getElementById('shop-status');
            if (!statusEl) return;

            const now = new Date();
            const day = now.getDay(); // 0 = Dimanche
            const hour = now.getHours();
            const minute = now.getMinutes();
            const totalMinutes = hour * 60 + minute;

            let isOpen = false;

            // Horaires : Lundi-Vendredi 07h00-20h00, Samedi 09h00-12h30
            if (day >= 1 && day <= 5) { // Lundi √† Vendredi
                if (totalMinutes >= 420 && totalMinutes < 1200) isOpen = true; // 07:00 - 20:00
            } else if (day === 6) { // Samedi
                if (totalMinutes >= 540 && totalMinutes < 750) isOpen = true; // 09:00 - 12:30
            }

            statusEl.classList.remove('hidden');
            if (isOpen) {
                statusEl.className = "ml-2 sm:ml-4 px-3 py-1 text-xs font-bold rounded-full bg-green-100 text-green-800 border border-green-200 dark:bg-green-900 dark:text-green-200 dark:border-green-700 flex items-center transition-colors duration-300";
                statusEl.innerHTML = '<span class="relative flex h-2 w-2 mr-2"><span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"></span><span class="relative inline-flex rounded-full h-2 w-2 bg-green-500"></span></span>Ouvert';
            } else {
                statusEl.className = "ml-2 sm:ml-4 px-3 py-1 text-xs font-bold rounded-full bg-red-100 text-red-800 border border-red-200 dark:bg-red-900 dark:text-red-200 dark:border-red-700 flex items-center transition-colors duration-300";
                statusEl.innerHTML = '<span class="h-2 w-2 rounded-full bg-red-500 mr-2"></span>Ferm√©';
            }
        }

        updateShopStatus();
        setInterval(updateShopStatus, 60000); // Mise √† jour chaque minute

        // Gestion Modale Confirmation
        const confirmationModal = document.getElementById('confirmation-modal');
        const closeConfirmationBtn = document.getElementById('close-confirmation-modal');
        const confirmationOverlay = document.getElementById('confirmation-modal-overlay');

        function closeConfirmation() {
            confirmationModal.classList.add('hidden');
        }

        if(closeConfirmationBtn) closeConfirmationBtn.addEventListener('click', closeConfirmation);
        if(confirmationOverlay) confirmationOverlay.addEventListener('click', closeConfirmation);
    </script>

</body>
</html>
